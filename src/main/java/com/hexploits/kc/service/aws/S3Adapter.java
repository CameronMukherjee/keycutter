package com.hexploits.kc.service.aws;

import io.micronaut.context.annotation.Value;
import jakarta.inject.Singleton;
import java.io.File;
import software.amazon.awssdk.services.s3.model.PutObjectRequest;

@Singleton
public class S3Adapter {

  private final S3Bean s3Bean;
  private final String s3Bucket;

  public S3Adapter(S3Bean s3Bean, @Value("${aws.bucket}") String s3Bucket) {
    this.s3Bean = s3Bean;
    this.s3Bucket = s3Bucket;
  }

  public void uploadFile(File file, String path, String fileExt) {
    PutObjectRequest request = PutObjectRequest.builder()
      .bucket(s3Bucket)
      .key("keycutter" + path + fileExt)
      .build();

    s3Bean.getS3Client().putObject(request, file.toPath());
  }
}
