package com.hexploits.kc.service;

import com.hexploits.kc.dto.response.ServerConfigResponse;
import io.micronaut.context.annotation.Value;
import jakarta.inject.Singleton;

@Singleton
public class KcServerConfigService {

  private final ServerConfigResponse config;

  public KcServerConfigService(
    @Value("${aws.region}") String awsRegion,
    @Value("${aws.bucket}") String awsBucket,
    @Value("${kc.email.provider:NONE}") String emailProvider,
    @Value("${kc.email.sender:NONE}") String emailSender,
    @Value("${kc.ui.username}") String uiUsername,
    @Value("${kc.ui.password}") String uiPassword,
    @Value("${kc.logs.login.period}") Long loginLogsRetentionPeriod,
    @Value("${kc.logs.login.strategy}") String loginLogsRetentionStrategy,
    @Value("${kc.logs.events.period}") Long eventLogsRetentionPeriod,
    @Value("${kc.logs.events.strategy}") String eventLogsRetentionStrategy,
    @Value("${kc.webhook.emit}") Boolean webhookEmit) {
    config = new ServerConfigResponse(
      awsRegion,
      awsBucket,
      emailProvider,
      emailSender,
      uiUsername,
      uiPassword,
      loginLogsRetentionPeriod,
      loginLogsRetentionStrategy,
      eventLogsRetentionPeriod,
      eventLogsRetentionStrategy,
      webhookEmit
    );
  }

  public ServerConfigResponse fetchConfig() {
    return config;
  }
}
